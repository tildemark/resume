<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: 'en' }}">

{%- include head.html -%}

<body class="{% if site.darkmode == true and site.darkmode != 'never' %}dark{% endif %}">

  {%- include header.html -%}

  <main class="page-content" aria-label="Content">
    <div class="wrapper">

      {%- if jekyll.environment == 'production' and site.gtm -%}
        {%- include gtm_body.html -%}
      {%- endif -%}

      {%- include about.html -%}

      {%- if site.version == 2 -%}
        {% for section in site.content %}
          <div class="container {{ section.layout }}-container">
            <h3 id="{{ section.title | slugify }}">{{ section.title }}</h3>
            {% include {{ section.layout | prepend: "section-" | append: ".html" }} content=section.content %}
          </div>
        {% endfor %}
      {% else %}
        {%- include v1/default.html -%}
      {%- endif -%}
    </div>
  </main>

  {%- include footer.html -%}
  {% if site.darkmode == false %}
    <script src="{{ '/assets/js/index.js' | relative_url }}"></script>
  {% endif %}

  // Light or Dark Toggle
  <div id="theme-toggle" onclick="toggleTheme()" aria-label="Toggle Dark/Light Mode">
    <i class="fas fa-sun" id="theme-icon"></i>
  </div>

  <script>
    // 1. Check LocalStorage on load
    const currentTheme = localStorage.getItem('theme');
    const icon = document.getElementById('theme-icon');
    
    if (currentTheme === 'light') {
      document.body.classList.add('light-mode');
      icon.classList.remove('fa-sun');
      icon.classList.add('fa-moon');
    }

    // 2. Toggle Function
    function toggleTheme() {
      document.body.classList.toggle('light-mode');
      
      // Check status and update icon/storage
      if (document.body.classList.contains('light-mode')) {
        localStorage.setItem('theme', 'light');
        icon.classList.remove('fa-sun');
        icon.classList.add('fa-moon');
      } else {
        localStorage.setItem('theme', 'dark');
        icon.classList.remove('fa-moon');
        icon.classList.add('fa-sun');
      }
    }
  </script>
</body>

</html>
